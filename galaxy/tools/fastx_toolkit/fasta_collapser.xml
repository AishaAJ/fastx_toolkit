<tool id="cshl_fasta_collapser" name="Collapse">
	<description>sequences</description>
	<command interpreter="perl">fasta_collapser.pl $GZIPOUT $input $output</command>

	<inputs>
		<param format="fasta" name="input" type="data" label="Library to collapse" />
		
		<param name="GZIPOUT" type="select" label="Compress output file (using GZIP) ">
			<option value="">no</option>
			<option value="-g">yes</option>
		</param>
	</inputs>

	<tests>
		<test>
			<param name="input" value="fasta_collapser1.fasta" />
			<param name="GZIPOUT" value=""/>
			<output name="output" file="fasta_collapser1.out" />
		</test>
	</tests>

	<outputs>
		<data format="fasta" name="output" metadata_source="input" label="$input.tag collapsed" />
	</outputs>
  <help>

**What it does**

This tool collapses identical sequences in a FASTA file into a single sequence.

--------

**Example**

Example Input File (Sequence "ATAT" appears multiple times):: 

    >HWI-EAS043_3_FC200MCAAXX_1_1_605_414
    TGCG
    >HWI-EAS043_3_FC200MCAAXX_1_1_537_759
    ATAT
    >HWI-EAS043_3_FC200MCAAXX_1_1_774_520
    TGGC
    >HWI-EAS043_3_FC200MCAAXX_1_1_742_502
    ATAT
    >HWI-EAS043_3_FC200MCAAXX_1_1_781_514
    TGAG
    >HWI-EAS043_3_FC200MCAAXX_1_1_757_487
    TTCA
    >HWI-EAS043_3_FC200MCAAXX_1_1_903_769
    ATAT
    >HWI-EAS043_3_FC200MCAAXX_1_1_724_499
    ATAT

Example Output file::

    >1-1
    TGCG
    >2-4
    ATAT
    >3-1
    TGGC
    >4-1
    TGAG
    >5-1
    TTCA
    
.. class:: infomark

Original Sequence Names / Lane descriptions (e.g. "HWI-EAS043_3_FC200MCAAXX_1_1_742_502") are discarded. 

The output seqeunce name is composed of two numbers: the first is the sequence's number, the second is the multiplicity value.

The following output::

    >2-4
    ATAT

means that the sequence "ATAT" is the second sequence in the file, and it appeared 4 times in the input FASTA file.

--------

Written by Assaf Gordon (gordon@cshl.edu) and Yaniv Erlich (erlich@cshl.edu)

</help>
</tool>
